{"version":3,"file":"bundle-festivals.js","mappings":";;;;;;;;;;;;;;AAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;UCNA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;ACN+C;;AAE/C;AACA;AACA;AACA,OAAO,6DAAW;AAClB;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iDAAiD,WAAW;AAC5D;AACA;AACA,SAAS;AACT,MAAM;AACN,uCAAuC,UAAU;AACjD;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN,yCAAyC,gBAAgB;AACzD;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,SAAS,uDAAuD,MAAM;;AAEtE;;AAEA;;AAEA;;AAEA;AACA,WAAW,6DAAW;AACtB;;AAEA;AACA;AACA,gEAAgE,WAAW,OAAO,WAAW;AAC7F;AACA;AACA;AACA,KAAK;AACL","sources":["webpack://programming-5/./src/main/js/modules/csrf.js","webpack://programming-5/webpack/bootstrap","webpack://programming-5/webpack/runtime/define property getters","webpack://programming-5/webpack/runtime/hasOwnProperty shorthand","webpack://programming-5/webpack/runtime/make namespace object","webpack://programming-5/./src/main/js/festivals.js"],"sourcesContent":["export function getCsrfInfo() {\n    const csrfToken = document.querySelector(\"meta[name=_csrf]\").content;\n    const csrfHeader = document.querySelector(\"meta[name=_csrf_header]\").content;\n    return {\n        [csrfHeader]: csrfToken\n    }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { getCsrfInfo } from './modules/csrf.js'\n\nconst headers = {\n    Accept: \"application/json\",\n    \"Content-Type\": \"application/json\",\n    ...getCsrfInfo()\n};\n\nconst deleteButtons = document.querySelectorAll(\"#deleteFestivalBtn\");\ndeleteButtons.forEach(deleteButton =>\n    deleteButton.addEventListener(\"click\", deleteFestival));\n\nasync function deleteFestival(event) {\n    const clickedButton = event.target;\n\n    const hiddenInput = clickedButton\n        .previousElementSibling;\n    const festivalId = parseInt(hiddenInput.value);\n\n    let response;\n    try {\n        response = await fetch(`/api/festivals/${festivalId}`, {\n            method: \"DELETE\",\n            headers\n        });\n    } catch (e) {\n        alert(`Something went wrong \"${e.message}\".`);\n    }\n\n    if (response.status === 204) {\n        const trToBeRemoved = clickedButton.parentElement.parentElement;\n        const parent = trToBeRemoved.parentElement;\n        parent.removeChild(trToBeRemoved);\n    } else {\n        alert(`Unsupported status code ${response.status}.`);\n    }\n}\n\nconst addFestivalBtn = document.getElementById(\"addFestivalBtn\");\nconst addFestivalForm = document.getElementById(\"addFestivalForm\");\nconst infoBox = document.getElementById('info-box-festival')\nconst infoSuccess = document.getElementById('info-success-festival')\nconst submitNewFestivalBtn = document.getElementById(\"submitNewFestivalBtn\");\n\naddFestivalBtn.addEventListener(\"click\", showAddFestivalForm);\nsubmitNewFestivalBtn.addEventListener(\"click\", processAddFestival);\n\nfunction showAddFestivalForm() {\n    if (addFestivalForm.hasAttribute(\"hidden\")) {\n        addFestivalForm.removeAttribute(\"hidden\");\n        infoBox.classList.add('visually-hidden')\n        infoSuccess.classList.add('visually-hidden')\n        addFestivalBtn.innerText = \"Cancel\";\n    } else {\n        addFestivalForm.toggleAttribute(\"hidden\");\n        addFestivalBtn.innerText = \"Add a Festival\";\n        document.getElementById('festivalName').value = null\n        document.getElementById('startDate').value = null\n        document.getElementById('lengthDays').value = null\n        document.getElementById('festivalType').value = festivalTypes.at(0)\n        document.getElementById('organizer').value = null\n        document.getElementById('cost').value = null\n        infoBox.classList.add('visually-hidden')\n        infoSuccess.classList.add('visually-hidden')\n        infoBox.innerText = \"\"\n    }\n}\n\nfunction processAddFestival() {\n    const festivalName = document.getElementById('festivalName').value\n    const startDate = document.getElementById('startDate').value\n    const lengthDays = document.getElementById('lengthDays').value\n    const festivalType = document.getElementById('festivalType').value\n    const organizer = document.getElementById('organizer').value\n    const cost = document.getElementById('cost').value\n\n    let festivalId = null;\n    fetch('/api/festivals', {\n        method: \"POST\",\n        headers,\n        body: JSON.stringify({\n            \"name\": festivalName,\n            \"startDate\": startDate,\n            \"lengthDays\": lengthDays,\n            \"festivalType\": festivalType,\n            \"organizer\": organizer,\n            \"cost\": cost,\n        })\n    })\n        .then(response => {\n            if (response.status === 201) {\n                infoBox.classList.add('visually-hidden')\n\n                festivalId = response.id;\n\n                if (document.getElementById('festivalImage').files[0] !== undefined) {\n                    const festivalImage = document.getElementById('festivalImage');\n                    response.json().then(festival => uploadFile(festival.id, festivalImage, festivalName))\n                }\n                infoSuccess.classList.remove('visually-hidden')\n\n            } else if (response.status === 400) {\n                infoBox.innerText = \"\"\n                response.json().then(data => {\n                    for (const error of data.details) {\n                        infoBox.innerText += error + \"\\n\"\n                    }\n                })\n                infoBox.classList.remove('visually-hidden')\n            }\n        }).catch(error => alert(`Cannot create Artist. Error: ${error}`))\n\n    const festivalImage = document.getElementById('festivalImage');\n\n}\n\nfunction uploadFile(festivalId, FestivalImage, festivalName) {\n\n    const headers = {\n        ...getCsrfInfo()\n    };\n\n    let formData = new FormData();\n    formData.append(\"file\", FestivalImage.files[0]);\n    let response = fetch(`/api/image/upload/festival/festival-${festivalId}.png/${festivalId}`, {\n        method: \"POST\",\n        headers,\n        body: formData\n    });\n}\n"],"names":[],"sourceRoot":""}